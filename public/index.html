<!DOCTYPE html>
<html>
<script src="https://cdn.jsdelivr.net/npm/dompurify@3.2.6/dist/purify.min.js"
        integrity="sha384-JEyTNhjM6R1ElGoJns4U2Ln4ofPcqzSsynQkmEc/KGy6336qAZl70tDLufbkla+3"
        crossorigin="anonymous"></script>

<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dash Platform Evo JS SDK</title>
  <link rel="icon" type="image/svg+xml" href="https://media.dash.org/wp-content/uploads/blue-d.svg">
  <link rel="alternate icon" type="image/png" href="https://media.dash.org/wp-content/uploads/blue-d-250.png">
  <link rel="stylesheet" href="index.css">
</head>

<body>
  <div class="header">
    <h1>Dash Platform Evo JS SDK</h1>
    <nav class="header-nav">
      <a href="docs.html">Documentation</a>
      <a href="AI_REFERENCE.md">AI Reference</a>
      <a href="https://github.com/dashpay/platform" target="_blank">GitHub</a>
    </nav>
  </div>

  <!-- Error Banner for API definitions loading failures -->
  <div id="apiErrorBanner" style="display: none; background-color: #f8d7da; color: #721c24; padding: 15px; margin: 0; border-bottom: 1px solid #f5c6cb; text-align: center;">
    <div style="display: flex; justify-content: center; align-items: center; gap: 15px; flex-wrap: wrap;">
      <span id="apiErrorMessage">Failed to load API definitions. Please check your connection and try again.</span>
      <button id="apiRetryButton" style="background-color: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 14px;">Retry</button>
    </div>
  </div>

  <div id="preloader">
    <div class="preloader-content">
      <div class="preloader-text" id="preloaderText">Loading Evo SDK...</div>
      <div class="preloader-progress">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-percent" id="progressPercent">0%</div>
      </div>
    </div>
  </div>

  <div class="app-container">
    <div class="sidebar">
      <div class="network-toggle">
        <label>Network:</label>
        <input type="radio" id="mainnet" name="network" value="mainnet">
        <label for="mainnet">Mainnet</label>
        <input type="radio" id="testnet" name="network" value="testnet">
        <label for="testnet">Testnet</label>
        <span id="networkIndicator" class="network-indicator mainnet">MAINNET</span>
        <br>
        <label style="margin-top: 10px; display: block;">
          <input type="checkbox" id="trustedMode" style="margin-right: 5px;" checked disabled>
          Trusted Quorums Mode
        </label>
      </div>

      <!-- SDK Configuration Section (Collapsible) -->
      <details class="sdk-config" style="margin: 0; padding: 0; border-bottom: 1px solid #e0e0e0;">
        <summary style="padding: 15px 20px; background-color: #f8f9fa; cursor: pointer; list-style: none; display: flex; justify-content: space-between; align-items: center;">
          <span style="font-weight: 500; color: #333;">Advanced SDK Configuration</span>
          <span style="font-size: 0.8em; color: #666;">â–¼</span>
        </summary>
        <div style="padding: 15px 20px; background-color: #f0f4f8;">
          <div style="margin-bottom: 10px;">
            <label style="display: block; margin-bottom: 5px; font-weight: 500;">Platform Version:</label>
            <div style="display: flex; gap: 10px; align-items: center;">
              <input type="number" id="platformVersion" placeholder="Latest" style="flex: 1; padding: 5px;" min="1">
              <span id="latestVersionInfo" style="font-size: 0.9em; color: #666;"></span>
            </div>
            <small style="color: #666;">Leave empty for latest version</small>
          </div>

          <details style="margin-top: 10px;">
            <summary style="cursor: pointer; font-weight: 500; margin-bottom: 10px;">Request Settings</summary>
            <div style="margin-top: 10px;">
              <label style="display: block; margin-bottom: 5px;">Connect Timeout (ms):</label>
              <input type="number" id="connectTimeout" placeholder="Default: 3000" style="width: 100%; padding: 5px;">
            </div>
            <div style="margin-top: 10px;">
              <label style="display: block; margin-bottom: 5px;">Request Timeout (ms):</label>
              <input type="number" id="requestTimeout" placeholder="Default: 60000" style="width: 100%; padding: 5px;">
            </div>
            <div style="margin-top: 10px;">
              <label style="display: block; margin-bottom: 5px;">Retries:</label>
              <input type="number" id="retries" placeholder="Default: 5" style="width: 100%; padding: 5px;">
            </div>
            <div style="margin-top: 10px;">
              <label style="display: flex; align-items: center;">
                <input type="checkbox" id="banFailedAddress" style="margin-right: 5px;">
                Ban Failed Addresses
              </label>
            </div>
          </details>

          <button id="applyConfig" style="margin-top: 15px; padding: 8px 15px; background-color: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer; width: 100%;">Apply Configuration</button>
        </div>
      </details>

      <div class="query-container">
        <div class="query-selector">
          <select id="operationType">
            <option value="queries">Queries</option>
            <option value="transitions">State Transitions</option>
            <option value="wallet">Wallet</option>
          </select>

          <select id="queryCategory">
            <option value="">Select Query Category</option>
          </select>

          <select id="queryType" style="display: none;">
            <option value="">Select Query Type</option>
          </select>
        </div>

        <div id="authenticationInputs" class="query-inputs" style="display: none;">
          <h4>Authentication</h4>
          <div class="input-group" id="identityIdGroup">
            <label for="identityId">Identity ID</label>
            <input type="text" id="identityId" placeholder="Enter identity ID">
          </div>
          <div class="input-group" id="assetLockProofGroup" style="display: none;">
            <label for="assetLockProof">Asset Lock Proof</label>
            <input type="text" id="assetLockProof" placeholder="Enter asset lock proof (hex encoded)">
          </div>
          <div class="input-group">
            <label for="privateKey">Private Key (WIF or hex, optionally with :keyId)</label>
            <input type="password" id="privateKey" placeholder="Enter private key (WIF or 32-byte hex)">
          </div>
        </div>

        <div id="queryDescription" class="query-description" style="display: none;"></div>

        <div id="queryInputs" class="query-inputs" style="display: none;">
          <h4 id="queryTitle">Query Parameters</h4>
          <div id="dynamicInputs"></div>
        </div>

        <div class="proof-toggle" style="display: none; margin: 15px 0;" id="proofToggleContainer">
          <label style="display: flex; align-items: center; margin: 0;">
            <span class="toggle-switch">
              <input type="checkbox" id="proofToggle">
              <span class="toggle-slider"></span>
            </span>
            <span style="margin-left: 60px; font-weight: 500; color: #333;">With Proof Info</span>
          </label>
        </div>

        <div class="no-proof-info" style="display: none; margin: 15px 0; padding: 10px; background-color: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; text-align: center;" id="noProofInfoContainer">
          <span style="color: #6c757d; font-size: 0.9em;">Note: this query does not provide cryptographic proof verification.</span>
        </div>

        <button id="executeQuery" class="execute-button" style="display: none;">Execute Query</button>
      </div>
    </div>

    <div class="result-container">
      <div class="result-header">
        <h2>Results</h2>
        <div class="result-actions">
          <button id="clearButton">Clear</button>
          <button id="copyButton">Copy</button>
          <button id="clearCacheButton" title="Clear Evo SDK cache and reload">Clear Cache</button>
        </div>
      </div>
      <div id="resultSplitContainer" class="result-split-container">
        <div id="identityInfo" class="result-content empty">No data fetched yet. Select a query category and type to begin.</div>
      </div>
    </div>
  </div>

    <div id="statusBanner" class="status-banner loading">Initializing Evo SDK...</div>

  <script type="module" src="./app.js"></script>

</body>
</html>
